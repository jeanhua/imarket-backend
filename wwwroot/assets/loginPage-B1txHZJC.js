import{d as P,r,c as g,e,t as U,b as c,w as _,T as b,o as w,l as m,v as p,s as k,q as C,_ as q}from"./index-BkUlVtEz.js";import{R as B}from"./request-BB6PRwq2.js";import{M as F}from"./modal-V-dFD9gs.js";const N={class:"login-page"},D={class:"head"},E={class:"content"},I={key:0,class:"form"},S={class:"input"},j={class:"form-item"},z={class:"form-item"},A={class:"option"},G={class:"register"},H={class:"forget"},J={key:0,class:"form"},K={class:"input"},L={class:"form-item"},O={class:"form-item"},Q={class:"form-item"},W={class:"option"},X={class:"back-to-login"},Y={key:0,class:"form"},Z={class:"input"},h={class:"form-item"},ee={class:"option"},se={class:"back-to-login"},te=P({__name:"loginPage",setup(oe){const V=r(null),l=r(""),u=r("login"),d=r(""),a=r(""),n=r(""),v=r(""),y=B.getInstance(),i=()=>{var o;(o=V.value)==null||o.openModal()},x=r("登陆"),M=o=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o),R=async()=>{if(!a.value||!n.value){l.value="用户名或密码不能为空",i();return}await y.login(a.value,n.value)||(l.value="登录失败，请检查用户名和密码",i())},T=async()=>{if(!d.value||!a.value||!n.value){l.value="所有字段都必须填写",i();return}if(!M(d.value)){l.value="请输入有效的邮箱地址",i();return}await y.register(d.value,a.value,n.value)?(l.value="注册成功，请登录",u.value="login"):l.value="注册失败，请重试",i()},$=async()=>{if(!v.value){l.value="请输入注册邮箱",i();return}if(!M(v.value)){l.value="请输入有效的邮箱地址",i();return}await y.forgetPassword(v.value)?(l.value="重置邮件已发送，请检查邮箱",u.value="login"):l.value="邮件发送失败，请检查邮箱",i()},f=o=>{x.value=o==="login"?"登录":o==="register"?"注册":"重置密码",u.value="_",setTimeout(()=>{u.value=o,d.value="",a.value="",n.value="",v.value=""},300)};return(o,s)=>(w(),g("div",N,[e("div",D,"iMarket "+U(x.value),1),e("div",E,[c(b,null,{default:_(()=>[u.value==="login"?(w(),g("div",I,[e("div",S,[e("div",j,[s[10]||(s[10]=e("label",{for:"username"},"用户名：",-1)),m(e("input",{type:"text",id:"username","onUpdate:modelValue":s[0]||(s[0]=t=>a.value=t)},null,512),[[p,a.value]])]),e("div",z,[s[11]||(s[11]=e("label",{for:"password"},"密码：",-1)),m(e("input",{type:"password",id:"password","onUpdate:modelValue":s[1]||(s[1]=t=>n.value=t)},null,512),[[p,n.value]])])]),e("div",A,[e("div",G,[e("a",{onClick:s[2]||(s[2]=k(t=>f("register"),["prevent"]))},"注册")]),e("div",H,[e("a",{onClick:s[3]||(s[3]=k(t=>f("forget"),["prevent"]))},"忘记密码")])]),e("div",{class:"form-item"},[e("button",{onClick:R},"登录")])])):C("",!0)]),_:1}),c(b,null,{default:_(()=>[u.value==="register"?(w(),g("div",J,[e("div",K,[e("div",L,[s[12]||(s[12]=e("label",{for:"email"},"邮箱：",-1)),m(e("input",{type:"email",id:"email","onUpdate:modelValue":s[4]||(s[4]=t=>d.value=t)},null,512),[[p,d.value]])]),e("div",O,[s[13]||(s[13]=e("label",{for:"reg-username"},"用户名：",-1)),m(e("input",{type:"text",id:"reg-username","onUpdate:modelValue":s[5]||(s[5]=t=>a.value=t)},null,512),[[p,a.value]])]),e("div",Q,[s[14]||(s[14]=e("label",{for:"reg-password"},"密码：",-1)),m(e("input",{type:"password",id:"reg-password","onUpdate:modelValue":s[6]||(s[6]=t=>n.value=t)},null,512),[[p,n.value]])])]),e("div",W,[e("div",X,[e("a",{onClick:s[7]||(s[7]=k(t=>f("login"),["prevent"]))},"返回登录")])]),e("div",{class:"form-item"},[e("button",{onClick:T},"注册")])])):C("",!0)]),_:1}),c(b,null,{default:_(()=>[u.value==="forget"?(w(),g("div",Y,[e("div",Z,[e("div",h,[s[15]||(s[15]=e("label",{for:"forget-email"},"注册邮箱：",-1)),m(e("input",{type:"email",id:"forget-email","onUpdate:modelValue":s[8]||(s[8]=t=>v.value=t)},null,512),[[p,v.value]])])]),e("div",ee,[e("div",se,[e("a",{onClick:s[9]||(s[9]=k(t=>f("login"),["prevent"]))},"返回登录")])]),e("div",{class:"form-item"},[e("button",{onClick:$},"发送重置邮件")])])):C("",!0)]),_:1})]),c(F,{ref_key:"modalRef",ref:V},{default:_(()=>[s[16]||(s[16]=e("h2",null,"提示",-1)),e("p",null,U(l.value),1)]),_:1},512)]))}}),ie=q(te,[["__scopeId","data-v-190e3187"]]);export{ie as default};
